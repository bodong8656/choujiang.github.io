<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>åŒç‰ˆæœ¬æŠ½å¥– - ä¿®å¤ç‰ˆ</title>
    <style>
        /* æ ·å¼ä»£ç ä¿æŒä¸å˜ï¼Œå¤ªé•¿è¿™é‡Œçœç•¥ï¼Œç”¨å®é™…ä»£ç  */
        * { margin: 0; padding: 0; box-sizing: border-box; touch-action: manipulation; }
        body { font-family: -apple-system, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; color: white; padding: 20px; }
        .container { max-width: 500px; margin: 0 auto; }
        .header { text-align: center; margin-bottom: 25px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 20px; }
        .title { font-size: 32px; font-weight: bold; margin-bottom: 10px; background: linear-gradient(45deg, #ffd700, #ff8c00); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .version-switcher { display: flex; background: rgba(255,255,255,0.1); border-radius: 15px; margin-bottom: 20px; overflow: hidden; }
        .version-btn { flex: 1; padding: 15px; text-align: center; font-size: 16px; cursor: pointer; transition: all 0.3s; }
        .version-btn.active { background: rgba(255,255,255,0.2); }
        .version-btn.premium { background: linear-gradient(45deg, #ffd700, #ff8c00); color: #333; }
        .version-btn.economy { background: linear-gradient(45deg, #00b09b, #96c93d); color: white; }
        .card { background: rgba(255,255,255,0.12); backdrop-filter: blur(10px); border-radius: 20px; padding: 25px; margin-bottom: 20px; }
        .result-area { text-align: center; padding: 30px 20px; min-height: 180px; display: flex; flex-direction: column; justify-content: center; align-items: center; }
        #resultText { font-size: 28px; font-weight: bold; margin: 15px 0; min-height: 60px; display: flex; align-items: center; justify-content: center; }
        .draw-btn { width: 100%; padding: 20px; font-size: 22px; font-weight: bold; color: white; background: linear-gradient(45deg, #FF416C, #FF4B2B); border: none; border-radius: 15px; cursor: pointer; margin-bottom: 15px; }
        .action-buttons { display: flex; gap: 10px; margin-top: 15px; }
        .action-btn { flex: 1; padding: 15px; font-size: 16px; border: none; border-radius: 12px; cursor: pointer; font-weight: bold; }
        .clear-btn { background: linear-gradient(45deg, #ff5858, #f09819); color: white; }
        .share-btn { background: linear-gradient(45deg, #00b09b, #96c93d); color: white; }
        .tab-bar { display: flex; background: rgba(255,255,255,0.1); border-radius: 15px; margin-bottom: 20px; overflow: hidden; }
        .tab-btn { flex: 1; padding: 15px; text-align: center; font-size: 16px; cursor: pointer; }
        .tab-btn.active { background: rgba(255,255,255,0.2); font-weight: bold; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">ğŸ° åŒç‰ˆæœ¬æŠ½å¥–</h1>
            <p class="subtitle">æ™®é€šç‰ˆ / ä½å»‰ç‰ˆè‡ªç”±åˆ‡æ¢</p>
        </div>
        
        <!-- ç‰ˆæœ¬åˆ‡æ¢å™¨ -->
        <div class="version-switcher">
            <div class="version-btn premium active" id="premiumBtn">
                æ™®é€šç‰ˆ
            </div>
            <div class="version-btn economy" id="economyBtn">
                ä½å»‰ç‰ˆ
            </div>
        </div>
        
        <div class="tab-bar">
            <div class="tab-btn active" id="tab0Btn">ğŸ¯ æŠ½å¥–</div>
            <div class="tab-btn" id="tab1Btn">ğŸ“Š è®°å½•</div>
            <div class="tab-btn" id="tab2Btn">ğŸ“ˆ æ¦‚ç‡</div>
        </div>
        
        <div id="tab0" class="tab-content active">
            <div class="card result-area">
                <div id="resultLabel">ç‚¹å‡»æŒ‰é’®å¼€å§‹æŠ½å¥–</div>
                <div id="resultText">ğŸ</div>
            </div>
            
            <button class="draw-btn" id="drawButton">
                ğŸ² å¼€å§‹æŠ½å¥–
            </button>
            
            <div class="action-buttons">
                <button class="action-btn clear-btn" id="clearBtn">
                    ğŸ—‘ï¸ æ¸…ç©ºè®°å½•
                </button>
                <button class="action-btn share-btn" id="shareBtn">
                    ğŸ“¤ åˆ†äº«
                </button>
            </div>
            
            <div class="stats">
                <div>
                    <div style="font-size: 14px; opacity: 0.8;">æŠ½å¥–æ¬¡æ•°</div>
                    <div id="drawCount" style="font-size: 24px; font-weight: bold;">0</div>
                </div>
                <div style="text-align: right;">
                    <div style="font-size: 14px; opacity: 0.8;">ç´¯è®¡é‡‘é¢</div>
                    <div id="totalAmount" style="font-size: 24px; font-weight: bold;">0 å…ƒ</div>
                </div>
            </div>
        </div>
        
        <div id="tab1" class="tab-content">
            <div class="card">
                <h3>ğŸ“‹ æŠ½å¥–å†å²</h3>
                <div class="history-list" id="historyList">
                    <div style="text-align: center; padding: 60px 20px; color: rgba(255,255,255,0.7);">
                        æš‚æ— æŠ½å¥–è®°å½•
                    </div>
                </div>
            </div>
        </div>
        
        <div id="tab2" class="tab-content">
            <div class="card">
                <h3>ğŸ¯ å¥–é¡¹è®¾ç½®</h3>
                <div class="prize-list" id="prizeList"></div>
            </div>
        </div>
    </div>

    <script>
        // ç¡®ä¿DOMå®Œå…¨åŠ è½½åå†ç»‘å®šäº‹ä»¶
        document.addEventListener('DOMContentLoaded', function() {
            console.log('é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹åˆå§‹åŒ–...');
            
            // ç‰ˆæœ¬é…ç½®
            const versions = {
                premium: {
                    name: "æ™®é€šç‰ˆ",
                    prizes: [2448, 24.88, 18.88, 16.88, 12.88, 6.88, 4.88, 2.88],
                    probabilities: [0.00001, 0.02, 0.03, 0.02, 0.03, 0.20, 0.35, 0.34999]
                },
                economy: {
                    name: "ä½å»‰ç‰ˆ",
                    prizes: [6.88, 5.88, 4.88, 3.88, 2.88, 1.88, 0.88],
                    probabilities: [0.10, 0.15, 0.15, 0.15, 0.15, 0.25, 0.25]
                }
            };
            
            let currentVersion = 'premium';
            let history = { premium: [], economy: [] };
            let drawCount = { premium: 0, economy: 0 };
            let totalAmount = { premium: 0, economy: 0 };
            
            // åŠ è½½æ•°æ®
            function loadData() {
                const saved = localStorage.getItem('lotteryData');
                if (saved) {
                    try {
                        const data = JSON.parse(saved);
                        history = data.history || { premium: [], economy: [] };
                        drawCount = data.drawCount || { premium: 0, economy: 0 };
                        totalAmount = data.totalAmount || { premium: 0, economy: 0 };
                        currentVersion = data.currentVersion || 'premium';
                    } catch (e) {
                        console.log('åŠ è½½æ•°æ®å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤å€¼');
                    }
                }
                updateDisplay();
            }
            
            // ä¿å­˜æ•°æ®
            function saveData() {
                const data = {
                    history: history,
                    drawCount: drawCount,
                    totalAmount: totalAmount,
                    currentVersion: currentVersion
                };
                localStorage.setItem('lotteryData', JSON.stringify(data));
            }
            
            // æ›´æ–°æ˜¾ç¤º
            function updateDisplay() {
                document.getElementById('drawCount').textContent = drawCount[currentVersion];
                document.getElementById('totalAmount').textContent = totalAmount[currentVersion].toFixed(2) + ' å…ƒ';
                renderPrizes();
                renderHistory();
                
                // æ›´æ–°ç‰ˆæœ¬æŒ‰é’®çŠ¶æ€
                document.getElementById('premiumBtn').classList.toggle('active', currentVersion === 'premium');
                document.getElementById('economyBtn').classList.toggle('active', currentVersion === 'economy');
            }
            
            // æ¸²æŸ“å¥–é¡¹
            function renderPrizes() {
                const container = document.getElementById('prizeList');
                const version = versions[currentVersion];
                
                let html = '';
                version.prizes.forEach((prize, index) => {
                    const prob = (version.probabilities[index] * 100).toFixed(2);
                    html += `
                        <div class="prize-item" style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; text-align: center; margin: 10px 0;">
                            <div style="font-size: 20px; font-weight: bold;">${prize.toFixed(2)}å…ƒ</div>
                            <div style="font-size: 14px; opacity: 0.8;">æ¦‚ç‡: ${prob}%</div>
                        </div>
                    `;
                });
                container.innerHTML = html;
            }
            
            // æ¸²æŸ“å†å²è®°å½•
            function renderHistory() {
                const container = document.getElementById('historyList');
                const currentHistory = history[currentVersion];
                
                if (currentHistory.length === 0) {
                    container.innerHTML = '<div style="text-align: center; padding: 60px 20px; color: rgba(255,255,255,0.7);">æš‚æ— æŠ½å¥–è®°å½•</div>';
                    return;
                }
                
                let html = '';
                currentHistory.slice(-20).reverse().forEach((prize, index) => {
                    html += `
                        <div class="history-item" style="background: rgba(255,255,255,0.1); padding: 12px 15px; margin: 8px 0; border-radius: 10px;">
                            <div>ç¬¬ ${currentHistory.length - index} æ¬¡</div>
                            <div style="font-weight: bold;">${prize.toFixed(2)} å…ƒ</div>
                        </div>
                    `;
                });
                container.innerHTML = html;
            }
            
            // æŠ½å¥–é€»è¾‘
            function drawPrize() {
                const version = versions[currentVersion];
                const r = Math.random();
                let cp = 0;
                
                for (let i = 0; i < version.prizes.length; i++) {
                    cp += version.probabilities[i];
                    if (r <= cp) {
                        return version.prizes[i];
                    }
                }
                return version.prizes[version.prizes.length - 1]; // å…œåº•
            }
            
            // æŠ½å¥–å‡½æ•°
            function startDraw() {
                console.log('å¼€å§‹æŠ½å¥–');
                const button = document.getElementById('drawButton');
                const resultLabel = document.getElementById('resultLabel');
                const resultText = document.getElementById('resultText');
                
                // ç¦ç”¨æŒ‰é’®é˜²æ­¢é‡å¤ç‚¹å‡»
                button.disabled = true;
                button.textContent = 'ğŸ² æŠ½å¥–ä¸­...';
                
                // ç®€å•åŠ¨ç”»
                let count = 0;
                const interval = setInterval(() => {
                    count++;
                    const tempPrize = versions[currentVersion].prizes[Math.floor(Math.random() * versions[currentVersion].prizes.length)];
                    resultText.textContent = `${tempPrize.toFixed(2)} å…ƒ`;
                    
                    if (count >= 10) {
                        clearInterval(interval);
                        
                        // è·å–æœ€ç»ˆç»“æœ
                        const prize = drawPrize();
                        resultLabel.textContent = 'âœ¨ æŠ½å¥–ç»“æœ';
                        resultText.textContent = `${prize.toFixed(2)} å…ƒ`;
                        
                        // æ›´æ–°è®°å½•
                        history[currentVersion].push(prize);
                        drawCount[currentVersion]++;
                        totalAmount[currentVersion] += prize;
                        
                        // ä¿å­˜æ•°æ®
                        saveData();
                        updateDisplay();
                        
                        // æ¢å¤æŒ‰é’®
                        setTimeout(() => {
                            button.disabled = false;
                            button.textContent = 'ğŸ² å†æ¬¡æŠ½å¥–';
                            resultLabel.textContent = 'ç‚¹å‡»æŒ‰é’®å¼€å§‹æŠ½å¥–';
                        }, 1000);
                    }
                }, 100);
            }
            
            // åˆ‡æ¢ç‰ˆæœ¬
            function switchVersion(version) {
                console.log('åˆ‡æ¢åˆ°ç‰ˆæœ¬:', version);
                currentVersion = version;
                updateDisplay();
                saveData();
            }
            
            // åˆ‡æ¢æ ‡ç­¾é¡µ
            function switchTab(tabIndex) {
                console.log('åˆ‡æ¢åˆ°æ ‡ç­¾:', tabIndex);
                // éšè—æ‰€æœ‰æ ‡ç­¾å†…å®¹
                document.getElementById('tab0').classList.remove('active');
                document.getElementById('tab1').classList.remove('active');
                document.getElementById('tab2').classList.remove('active');
                
                // ç§»é™¤æ‰€æœ‰æ ‡ç­¾çš„activeç±»
                document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
                
                // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾å†…å®¹
                document.getElementById(`tab${tabIndex}`).classList.add('active');
                document.getElementById(`tab${tabIndex}Btn`).classList.add('active');
            }
            
            // æ¸…ç©ºè®°å½•
            function clearRecords() {
                if (confirm('ç¡®å®šè¦æ¸…ç©ºå½“å‰ç‰ˆæœ¬çš„è®°å½•å—ï¼Ÿ')) {
                    history[currentVersion] = [];
                    drawCount[currentVersion] = 0;
                    totalAmount[currentVersion] = 0;
                    saveData();
                    updateDisplay();
                    alert('è®°å½•å·²æ¸…ç©ºï¼');
                }
            }
            
            // åˆ†äº«ç»“æœ
            function shareResults() {
                if (history[currentVersion].length === 0) {
                    alert('æš‚æ— æŠ½å¥–è®°å½•å¯åˆ†äº«');
                    return;
                }
                
                const lastPrize = history[currentVersion][history[currentVersion].length - 1];
                const shareText = `ğŸ° æˆ‘åœ¨${versions[currentVersion].name}æŠ½å¥–ä¸­è·å¾—äº† ${lastPrize.toFixed(2)} å…ƒï¼`;
                
                if (navigator.share) {
                    navigator.share({
                        title: 'æŠ½å¥–ç»“æœ',
                        text: shareText
                    });
                } else {
                    navigator.clipboard.writeText(shareText).then(() => {
                        alert('ç»“æœå·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
                    });
                }
            }
            
            // ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
            function bindEvents() {
                console.log('ç»‘å®šäº‹ä»¶ç›‘å¬å™¨...');
                
                // æŠ½å¥–æŒ‰é’®
                document.getElementById('drawButton').addEventListener('click', startDraw);
                
                // ç‰ˆæœ¬åˆ‡æ¢æŒ‰é’®
                document.getElementById('premiumBtn').addEventListener('click', () => switchVersion('premium'));
                document.getElementById('economyBtn').addEventListener('click', () => switchVersion('economy'));
                
                // æ ‡ç­¾é¡µæŒ‰é’®
                document.getElementById('tab0Btn').addEventListener('click', () => switchTab(0));
                document.getElementById('tab1Btn').addEventListener('click', () => switchTab(1));
                document.getElementById('tab2Btn').addEventListener('click', () => switchTab(2));
                
                // æ¸…ç©ºæŒ‰é’®
                document.getElementById('clearBtn').addEventListener('click', clearRecords);
                
                // åˆ†äº«æŒ‰é’®
                document.getElementById('shareBtn').addEventListener('click', shareResults);
                
                console.log('äº‹ä»¶ç»‘å®šå®Œæˆ');
            }
            
            // åˆå§‹åŒ–
            function init() {
                console.log('åˆå§‹åŒ–åº”ç”¨...');
                loadData();
                bindEvents();
                console.log('åº”ç”¨åˆå§‹åŒ–å®Œæˆï¼Œå½“å‰ç‰ˆæœ¬:', currentVersion);
                
                // æµ‹è¯•æŒ‰é’®
                console.log('æŠ½å¥–æŒ‰é’®:', document.getElementById('drawButton'));
                console.log('ç‰ˆæœ¬æŒ‰é’®:', document.getElementById('premiumBtn'), document.getElementById('economyBtn'));
            }
            
            // å¯åŠ¨åº”ç”¨
            init();
        });
    </script>
</body>
</html>